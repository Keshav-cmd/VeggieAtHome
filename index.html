<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local Veggie Market</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-green: #2e7d32;
            --light-green: #4caf50;
            --dark-green: #1b5e20;
            --accent-orange: #ff9800;
            --light-gray: #f5f5f5;
            --medium-gray: #e0e0e0;
            --dark-gray: #616161;
            --text-color: #333;
            --white: #ffffff;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f9f9f9;
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: var(--primary-green);
            color: white;
            padding: 1rem 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
        }

        .logo i {
            color: var(--accent-orange);
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 4px;
            transition: background-color 0.3s;
            font-weight: 500;
        }

        nav a:hover, nav a.active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-type-selector {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            gap: 10px;
        }

        .user-type-btn {
            padding: 12px 24px;
            background-color: var(--white);
            border: 2px solid var(--medium-gray);
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .user-type-btn.active {
            background-color: var(--light-green);
            color: white;
            border-color: var(--light-green);
        }

        .user-type-btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }

        .dashboard {
            background-color: var(--white);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            display: none;
        }

        .dashboard.active {
            display: block;
        }

        .dashboard-title {
            color: var(--primary-green);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--medium-gray);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-gray);
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--medium-gray);
            border-radius: 6px;
            font-size: 16px;
            transition: border 0.3s;
        }

        .form-control:focus {
            border-color: var(--light-green);
            outline: none;
        }

        .btn {
            padding: 12px 24px;
            background-color: var(--primary-green);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background-color: var(--dark-green);
        }

        .btn-orange {
            background-color: var(--accent-orange);
        }

        .btn-orange:hover {
            background-color: #e68900;
        }

        .btn-red {
            background-color: #f44336;
        }

        .btn-red:hover {
            background-color: #d32f2f;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 14px;
        }

        .vegetable-list, .vendor-list, .delivery-partner-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .card {
            background-color: var(--white);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid var(--medium-gray);
            transition: transform 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary-green);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .price {
            color: var(--accent-orange);
            font-weight: 700;
            font-size: 1.3rem;
        }

        .vendor-info, .delivery-info {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            font-size: 0.9rem;
            color: var(--dark-gray);
        }

        .order-summary {
            background-color: var(--light-gray);
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }

        .order-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
        }

        .order-total {
            font-weight: 700;
            font-size: 1.2rem;
            border-top: 2px solid var(--medium-gray);
            padding-top: 15px;
            color: var(--primary-green);
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .status-online {
            background-color: #4caf50;
        }

        .status-offline {
            background-color: #f44336;
        }

        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--primary-green);
            color: white;
            padding: 15px 20px;
            border-radius: 6px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: transform 0.5s, opacity 0.5s;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 80vh;
        }

        .login-box {
            background-color: var(--white);
            border-radius: 12px;
            padding: 40px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 400px;
        }

        .login-title {
            text-align: center;
            color: var(--primary-green);
            margin-bottom: 30px;
            font-size: 1.8rem;
        }

        .login-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 25px;
        }

        .login-option {
            padding: 15px;
            border: 2px solid var(--medium-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-weight: 600;
        }

        .login-option:hover {
            border-color: var(--light-green);
            transform: translateY(-3px);
        }

        .login-option.selected {
            border-color: var(--light-green);
            background-color: rgba(76, 175, 80, 0.1);
        }

        .login-form {
            display: none;
        }

        .login-form.active {
            display: block;
        }

        .logout-btn {
            background-color: transparent;
            border: 1px solid white;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
        }

        .logout-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .user-greeting {
            font-weight: 500;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--medium-gray);
            color: var(--dark-gray);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }

            nav ul {
                flex-wrap: wrap;
                justify-content: center;
            }

            .user-type-selector {
                flex-wrap: wrap;
            }

            .dashboard {
                padding: 20px;
            }

            .vegetable-list, .vendor-list, .delivery-partner-list {
                grid-template-columns: 1fr;
            }

            .login-box {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Login Page (Initially visible) -->
    <div id="login-page" class="login-container">
        <div class="login-box">
            <h1 class="login-title">
                <i class="fas fa-carrot"></i> Local Veggie Market
            </h1>
            <p style="text-align: center; margin-bottom: 20px; color: var(--dark-gray);">
                Please select your user type and login
            </p>
            
            <div class="login-options">
                <div class="login-option" data-user-type="customer">
                    <i class="fas fa-shopping-basket"></i> Customer Login
                </div>
                <div class="login-option" data-user-type="vendor">
                    <i class="fas fa-store"></i> Vendor Login
                </div>
                <div class="login-option" data-user-type="delivery">
                    <i class="fas fa-truck"></i> Delivery Partner Login
                </div>
            </div>
            
            <div id="customer-login-form" class="login-form">
                <div class="form-group">
                    <label for="customer-email">Email</label>
                    <input type="email" id="customer-email" class="form-control" placeholder="customer@example.com" value="customer@example.com">
                </div>
                <div class="form-group">
                    <label for="customer-password">Password</label>
                    <input type="password" id="customer-password" class="form-control" placeholder="Enter password" value="password123">
                </div>
                <button class="btn btn-orange" id="customer-login-btn" style="width: 100%;">
                    <i class="fas fa-sign-in-alt"></i> Login as Customer
                </button>
            </div>
            
            <div id="vendor-login-form" class="login-form">
                <div class="form-group">
                    <label for="vendor-email">Email</label>
                    <input type="email" id="vendor-email" class="form-control" placeholder="vendor@example.com" value="vendor@example.com">
                </div>
                <div class="form-group">
                    <label for="vendor-password">Password</label>
                    <input type="password" id="vendor-password" class="form-control" placeholder="Enter password" value="password123">
                </div>
                <button class="btn btn-orange" id="vendor-login-btn" style="width: 100%;">
                    <i class="fas fa-sign-in-alt"></i> Login as Vendor
                </button>
            </div>
            
            <div id="delivery-login-form" class="login-form">
                <div class="form-group">
                    <label for="delivery-email">Email</label>
                    <input type="email" id="delivery-email" class="form-control" placeholder="delivery@example.com" value="delivery@example.com">
                </div>
                <div class="form-group">
                    <label for="delivery-password">Password</label>
                    <input type="password" id="delivery-password" class="form-control" placeholder="Enter password" value="password123">
                </div>
                <button class="btn btn-orange" id="delivery-login-btn" style="width: 100%;">
                    <i class="fas fa-sign-in-alt"></i> Login as Delivery Partner
                </button>
            </div>
            
            <div style="margin-top: 20px; text-align: center; color: var(--dark-gray); font-size: 0.9rem;">
                <p>Demo credentials: Use any email with password "password123"</p>
            </div>
        </div>
    </div>
    
    <!-- Main App (Initially hidden) -->
    <div id="main-app" style="display: none;">
        <header>
            <div class="header-content">
                <div class="logo" id="home-logo">
                    <i class="fas fa-carrot"></i>
                    <span>Local Veggie Market</span>
                </div>
                <nav>
                    <ul>
                        <li><a href="#" class="nav-link active" data-target="customer">Customer</a></li>
                        <li><a href="#" class="nav-link" data-target="vendor">Vendor</a></li>
                        <li><a href="#" class="nav-link" data-target="delivery">Delivery Partner</a></li>
                    </ul>
                </nav>
                <div class="user-info">
                    <span class="user-greeting" id="user-greeting">Welcome, Customer!</span>
                    <button class="logout-btn" id="logout-btn">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
        </header>

        <div class="container">
            <div class="user-type-selector">
                <button class="user-type-btn active" data-target="customer">
                    <i class="fas fa-shopping-basket"></i> Customer
                </button>
                <button class="user-type-btn" data-target="vendor">
                    <i class="fas fa-store"></i> Vendor
                </button>
                <button class="user-type-btn" data-target="delivery">
                    <i class="fas fa-truck"></i> Delivery Partner
                </button>
            </div>

            <!-- Customer Dashboard -->
            <div id="customer-dashboard" class="dashboard active">
                <h2 class="dashboard-title">
                    <i class="fas fa-shopping-basket"></i> Shop Fresh Vegetables
                </h2>
                
                <div class="form-group">
                    <label for="vendor-select">Select Vendor</label>
                    <select id="vendor-select" class="form-control">
                        <option value="">-- Choose a vendor --</option>
                        <option value="1">Green Fields Farm</option>
                        <option value="2">Organic Harvest</option>
                        <option value="3">Local Veggie King</option>
                    </select>
                </div>

                <div class="vegetable-list">
                    <!-- Vegetables will be populated here -->
                </div>

                <div class="form-group">
                    <label for="delivery-partner-select">Select Delivery Partner</label>
                    <select id="delivery-partner-select" class="form-control">
                        <option value="">-- Choose a delivery partner --</option>
                        <option value="1">Quick Veggie Delivery</option>
                        <option value="2">Fast Farm Transport</option>
                        <option value="3">Green Express</option>
                    </select>
                </div>

                <div class="order-summary">
                    <h3>Order Summary</h3>
                    <div class="order-row">
                        <span>Vegetable Cost:</span>
                        <span id="vegetable-cost">₹0</span>
                    </div>
                    <div class="order-row">
                        <span>Delivery Cost:</span>
                        <span id="delivery-cost">₹0</span>
                    </div>
                    <div class="order-row">
                        <span>Tax (5%):</span>
                        <span id="tax-cost">₹0</span>
                    </div>
                    <div class="order-row order-total">
                        <span>Total Cost:</span>
                        <span id="total-cost">₹0</span>
                    </div>
                    <button class="btn btn-orange" id="place-order-btn" style="margin-top: 15px; width: 100%;">
                        <i class="fas fa-check-circle"></i> Place Order
                    </button>
                </div>
                
                <!-- Recent Orders Section -->
                <div style="margin-top: 40px;">
                    <h3 class="dashboard-title">
                        <i class="fas fa-history"></i> Recent Orders
                    </h3>
                    <div id="recent-orders">
                        <!-- Recent orders will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Vendor Dashboard -->
            <div id="vendor-dashboard" class="dashboard">
                <h2 class="dashboard-title">
                    <i class="fas fa-store"></i> Update Vegetable Prices
                </h2>
                
                <div class="form-group">
                    <label for="vendor-name">Vendor Name</label>
                    <input type="text" id="vendor-name" class="form-control" value="Green Fields Farm">
                </div>

                <div class="form-group">
                    <label for="vendor-status">Store Status</label>
                    <select id="vendor-status" class="form-control">
                        <option value="online">Online (Open for Business)</option>
                        <option value="offline">Offline (Closed)</option>
                    </select>
                </div>

                <div class="vegetable-list" id="vendor-vegetable-list">
                    <!-- Vendor's vegetables will be populated here -->
                </div>

                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="btn" id="update-prices-btn">
                        <i class="fas fa-sync-alt"></i> Update All Prices
                    </button>
                    <button class="btn btn-orange" id="add-vegetable-btn">
                        <i class="fas fa-plus"></i> Add New Vegetable
                    </button>
                </div>
                
                <!-- Vendor Statistics -->
                <div style="margin-top: 40px;">
                    <h3 class="dashboard-title">
                        <i class="fas fa-chart-line"></i> Today's Statistics
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div class="card">
                            <div class="card-title">
                                <span>Total Orders</span>
                                <span class="price" id="vendor-total-orders">12</span>
                            </div>
                            <p>Orders received today</p>
                        </div>
                        <div class="card">
                            <div class="card-title">
                                <span>Revenue</span>
                                <span class="price" id="vendor-revenue">₹2,450</span>
                            </div>
                            <p>Total earnings today</p>
                        </div>
                        <div class="card">
                            <div class="card-title">
                                <span>Popular Item</span>
                                <span class="price">Tomatoes</span>
                            </div>
                            <p>Most sold today</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Delivery Partner Dashboard -->
            <div id="delivery-dashboard" class="dashboard">
                <h2 class="dashboard-title">
                    <i class="fas fa-truck"></i> Set Delivery Charges
                </h2>
                
                <div class="form-group">
                    <label for="delivery-name">Delivery Partner Name</label>
                    <input type="text" id="delivery-name" class="form-control" value="Quick Veggie Delivery">
                </div>

                <div class="form-group">
                    <label for="delivery-status">Delivery Status</label>
                    <select id="delivery-status" class="form-control">
                        <option value="online">Online (Available for Delivery)</option>
                        <option value="offline">Offline (Not Available)</option>
                    </select>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px;">
                    <div class="form-group">
                        <label for="base-distance">Base Distance (km)</label>
                        <input type="number" id="base-distance" class="form-control" value="5" min="1" max="50">
                        <small style="color: var(--dark-gray);">Minimum distance for base fee</small>
                    </div>

                    <div class="form-group">
                        <label for="base-weight">Base Weight (kg)</label>
                        <input type="number" id="base-weight" class="form-control" value="2" min="0.5" max="20" step="0.5">
                        <small style="color: var(--dark-gray);">Maximum weight for base fee</small>
                    </div>

                    <div class="form-group">
                        <label for="fuel-cost">Current Fuel Cost (per liter)</label>
                        <input type="number" id="fuel-cost" class="form-control" value="95" min="50" max="200">
                        <small style="color: var(--dark-gray);">Current fuel price</small>
                    </div>
                </div>

                <div class="form-group">
                    <label for="delivery-fee">Delivery Fee</label>
                    <input type="text" id="delivery-fee" class="form-control" value="₹45" readonly>
                    <small style="color: var(--dark-gray);">Calculated based on distance, weight and fuel cost</small>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="btn" id="update-delivery-btn">
                        <i class="fas fa-calculator"></i> Calculate & Update Delivery Fee
                    </button>
                    <button class="btn btn-orange" id="apply-fee-btn">
                        <i class="fas fa-check"></i> Apply Fee to All Orders
                    </button>
                </div>

                <div style="margin-top: 40px;">
                    <h3 class="dashboard-title">
                        <i class="fas fa-truck-loading"></i> Today's Deliveries
                    </h3>
                    <div class="delivery-partner-list" id="todays-deliveries">
                        <!-- Today's deliveries will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <div id="notification" class="notification">
            <i class="fas fa-check-circle"></i>
            <span>Operation completed successfully!</span>
        </div>

        <div class="footer">
            <p>Local Veggie Market &copy; 2026 | Connecting Local Vendors with Customers</p>
            <p>All prices are in Indian Rupees (₹)</p>
        </div>
    </div>

    <script>
        // Sample data
        const vegetables = [
            { id: 1, name: "Tomatoes", basePrice: 40, vendorPrices: {1: 40, 2: 45, 3: 38}, unit: "kg" },
            { id: 2, name: "Potatoes", basePrice: 25, vendorPrices: {1: 25, 2: 28, 3: 22}, unit: "kg" },
            { id: 3, name: "Onions", basePrice: 30, vendorPrices: {1: 30, 2: 32, 3: 28}, unit: "kg" },
            { id: 4, name: "Carrots", basePrice: 50, vendorPrices: {1: 50, 2: 55, 3: 48}, unit: "kg" },
            { id: 5, name: "Spinach", basePrice: 20, vendorPrices: {1: 20, 2: 25, 3: 18}, unit: "bunch" },
            { id: 6, name: "Bell Peppers", basePrice: 60, vendorPrices: {1: 60, 2: 65, 3: 58}, unit: "kg" },
            { id: 7, name: "Cucumbers", basePrice: 25, vendorPrices: {1: 25, 2: 28, 3: 22}, unit: "piece" },
            { id: 8, name: "Cauliflower", basePrice: 35, vendorPrices: {1: 35, 2: 40, 3: 32}, unit: "piece" }
        ];

        const vendors = [
            { id: 1, name: "Green Fields Farm", rating: 4.5, status: "online" },
            { id: 2, name: "Organic Harvest", rating: 4.7, status: "online" },
            { id: 3, name: "Local Veggie King", rating: 4.3, status: "offline" }
        ];

        const deliveryPartners = [
            { id: 1, name: "Quick Veggie Delivery", rating: 4.4, baseFee: 40, status: "online" },
            { id: 2, name: "Fast Farm Transport", rating: 4.2, baseFee: 35, status: "online" },
            { id: 3, name: "Green Express", rating: 4.6, baseFee: 45, status: "offline" }
        ];

        // State
        let currentUserType = "customer";
        let currentUserId = 1; // 1=customer, 2=vendor, 3=delivery
        let selectedVendor = 1;
        let selectedDeliveryPartner = 1;
        let selectedVegetables = {};
        let currentDeliveryFee = 40;
        let recentOrders = [];
        let todayDeliveries = [];

        // DOM Elements
        const loginPage = document.getElementById('login-page');
        const mainApp = document.getElementById('main-app');
        const userTypeBtns = document.querySelectorAll('.user-type-btn');
        const navLinks = document.querySelectorAll('.nav-link');
        const dashboards = document.querySelectorAll('.dashboard');
        const vendorSelect = document.getElementById('vendor-select');
        const deliveryPartnerSelect = document.getElementById('delivery-partner-select');
        const vegetableList = document.querySelector('.vegetable-list');
        const vendorVegetableList = document.getElementById('vendor-vegetable-list');
        const notification = document.getElementById('notification');
        const logoutBtn = document.getElementById('logout-btn');
        const homeLogo = document.getElementById('home-logo');
        const userGreeting = document.getElementById('user-greeting');

        // Login Elements
        const loginOptions = document.querySelectorAll('.login-option');
        const loginForms = document.querySelectorAll('.login-form');
        const customerLoginBtn = document.getElementById('customer-login-btn');
        const vendorLoginBtn = document.getElementById('vendor-login-btn');
        const deliveryLoginBtn = document.getElementById('delivery-login-btn');

        // Initialize the app
        function initApp() {
            // Set up event listeners
            setupEventListeners();
            
            // Initialize sample data
            initializeSampleData();
        }

        // Initialize sample data
        function initializeSampleData() {
            // Create some sample recent orders
            recentOrders = [
                { id: 1, date: "Today", vendor: "Green Fields Farm", items: "Tomatoes (2kg), Carrots (1kg)", total: "₹130", status: "Delivered" },
                { id: 2, date: "Yesterday", vendor: "Organic Harvest", items: "Spinach (2 bunches), Cucumbers (3 pieces)", total: "₹110", status: "Delivered" },
                { id: 3, date: "2 days ago", vendor: "Local Veggie King", items: "Potatoes (5kg), Onions (3kg)", total: "₹215", status: "Cancelled" }
            ];

            // Create sample deliveries
            todayDeliveries = [
                { id: 1, orderId: "#ORD-1001", customer: "Rahul Sharma", address: "MG Road, Sector 5", amount: "₹180", status: "In Transit" },
                { id: 2, orderId: "#ORD-1002", customer: "Priya Patel", address: "Green Park Colony", amount: "₹225", status: "Delivered" },
                { id: 3, orderId: "#ORD-1003", customer: "Amit Verma", address: "Civil Lines", amount: "₹150", status: "Pending" },
                { id: 4, orderId: "#ORD-1004", customer: "Sneha Reddy", address: "Model Town", amount: "₹310", status: "In Transit" }
            ];
        }

        // Set up event listeners
        function setupEventListeners() {
            // Login options
            loginOptions.forEach(option => {
                option.addEventListener('click', () => {
                    const userType = option.getAttribute('data-user-type');
                    selectLoginOption(userType);
                });
            });

            // Login buttons
            customerLoginBtn.addEventListener('click', () => login('customer'));
            vendorLoginBtn.addEventListener('click', () => login('vendor'));
            deliveryLoginBtn.addEventListener('click', () => login('delivery'));

            // Logout button
            logoutBtn.addEventListener('click', logout);

            // Home logo
            homeLogo.addEventListener('click', () => {
                switchUserType('customer');
            });

            // User type buttons
            userTypeBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const target = btn.getAttribute('data-target');
                    switchUserType(target);
                });
            });

            // Navigation links
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const target = link.getAttribute('data-target');
                    switchUserType(target);
                });
            });

            // Vendor selection
            vendorSelect.addEventListener('change', (e) => {
                selectedVendor = parseInt(e.target.value);
                loadCustomerDashboard();
                updateOrderSummary();
            });

            // Delivery partner selection
            deliveryPartnerSelect.addEventListener('change', (e) => {
                selectedDeliveryPartner = parseInt(e.target.value);
                updateDeliveryFee();
                updateOrderSummary();
            });

            // Place order button
            document.getElementById('place-order-btn').addEventListener('click', placeOrder);

            // Update prices button
            document.getElementById('update-prices-btn').addEventListener('click', updateVendorPrices);

            // Add vegetable button
            document.getElementById('add-vegetable-btn').addEventListener('click', addNewVegetable);

            // Update delivery fee button
            document.getElementById('update-delivery-btn').addEventListener('click', calculateDeliveryFee);

            // Apply fee button
            document.getElementById('apply-fee-btn').addEventListener('click', applyDeliveryFee);

            // Vendor status change
            document.getElementById('vendor-status').addEventListener('change', updateVendorStatus);

            // Delivery status change
            document.getElementById('delivery-status').addEventListener('change', updateDeliveryStatus);

            // Inputs for delivery fee calculation
            document.getElementById('base-distance').addEventListener('input', calculateDeliveryFee);
            document.getElementById('base-weight').addEventListener('input', calculateDeliveryFee);
            document.getElementById('fuel-cost').addEventListener('input', calculateDeliveryFee);
        }

        // Select login option
        function selectLoginOption(userType) {
            // Update selected option
            loginOptions.forEach(option => {
                if (option.getAttribute('data-user-type') === userType) {
                    option.classList.add('selected');
                } else {
                    option.classList.remove('selected');
                }
            });

            // Show corresponding login form
            loginForms.forEach(form => {
                if (form.id === `${userType}-login-form`) {
                    form.classList.add('active');
                } else {
                    form.classList.remove('active');
                }
            });
        }

        // Login function
        function login(userType) {
            // Simple validation (in real app, this would check with server)
            const emailField = document.getElementById(`${userType}-email`);
            const passwordField = document.getElementById(`${userType}-password`);
            
            if (!emailField.value || !passwordField.value) {
                showNotification("Please enter email and password", "error");
                return;
            }
            
            // Set user type and ID
            currentUserType = userType;
            currentUserId = userType === 'customer' ? 1 : userType === 'vendor' ? 2 : 3;
            
            // Update greeting
            userGreeting.textContent = `Welcome, ${userType.charAt(0).toUpperCase() + userType.slice(1)}!`;
            
            // Hide login, show main app
            loginPage.style.display = 'none';
            mainApp.style.display = 'block';
            
            // Load appropriate dashboard
            switchUserType(userType);
            
            // Populate vendor and delivery partner dropdowns
            populateSelectOptions();
            
            // Load dashboards
            loadCustomerDashboard();
            loadVendorDashboard();
            loadDeliveryDashboard();
            
            // Update order summary
            updateOrderSummary();
            
            showNotification(`Successfully logged in as ${userType}`);
        }

        // Logout function
        function logout() {
            // Reset state
            selectedVegetables = {};
            
            // Show login, hide main app
            loginPage.style.display = 'flex';
            mainApp.style.display = 'none';
            
            // Reset login forms
            loginOptions.forEach(option => option.classList.remove('selected'));
            loginForms.forEach(form => form.classList.remove('active'));
            
            showNotification("Successfully logged out");
        }

        // Switch between user types
        function switchUserType(userType) {
            currentUserType = userType;
            
            // Update active button
            userTypeBtns.forEach(btn => {
                if (btn.getAttribute('data-target') === userType) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            // Update active nav link
            navLinks.forEach(link => {
                if (link.getAttribute('data-target') === userType) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });

            // Show active dashboard
            dashboards.forEach(dashboard => {
                if (dashboard.id === `${userType}-dashboard`) {
                    dashboard.classList.add('active');
                } else {
                    dashboard.classList.remove('active');
                }
            });
        }

        // Populate select options
        function populateSelectOptions() {
            // Clear existing options except first one
            while (vendorSelect.options.length > 1) {
                vendorSelect.remove(1);
            }
            
            while (deliveryPartnerSelect.options.length > 1) {
                deliveryPartnerSelect.remove(1);
            }

            // Populate vendor select
            vendors.forEach(vendor => {
                const option = document.createElement('option');
                option.value = vendor.id;
                option.textContent = `${vendor.name} (${vendor.status === 'online' ? '✅' : '❌'})`;
                vendorSelect.appendChild(option);
            });

            // Populate delivery partner select
            deliveryPartners.forEach(partner => {
                const option = document.createElement('option');
                option.value = partner.id;
                option.textContent = `${partner.name} (${partner.status === 'online' ? '✅' : '❌'})`;
                deliveryPartnerSelect.appendChild(option);
            });

            // Set default selections
            vendorSelect.value = selectedVendor;
            deliveryPartnerSelect.value = selectedDeliveryPartner;
        }

        // Load customer dashboard
        function loadCustomerDashboard() {
            if (!selectedVendor) return;
            
            vegetableList.innerHTML = '';
            
            vegetables.forEach(veg => {
                const price = veg.vendorPrices[selectedVendor] || veg.basePrice;
                const quantity = selectedVegetables[veg.id] || 0;
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-title">
                        <span>${veg.name}</span>
                        <span class="price">₹${price}/${veg.unit}</span>
                    </div>
                    <p>Fresh ${veg.name.toLowerCase()} from local farms</p>
                    <div class="vendor-info">
                        <span>Available: ${veg.vendorPrices[selectedVendor] ? 'Yes' : 'No'}</span>
                        <div>
                            <button class="btn btn-small" data-action="decrease" data-id="${veg.id}">
                                <i class="fas fa-minus"></i>
                            </button>
                            <span style="margin: 0 10px;" id="qty-${veg.id}">${quantity}</span>
                            <button class="btn btn-small" data-action="increase" data-id="${veg.id}">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                vegetableList.appendChild(card);
            });

            // Add event listeners to quantity buttons
            document.querySelectorAll('[data-action="increase"]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.closest('button').getAttribute('data-id'));
                    selectedVegetables[id] = (selectedVegetables[id] || 0) + 1;
                    document.getElementById(`qty-${id}`).textContent = selectedVegetables[id];
                    updateOrderSummary();
                });
            });

            document.querySelectorAll('[data-action="decrease"]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.closest('button').getAttribute('data-id'));
                    if (selectedVegetables[id] && selectedVegetables[id] > 0) {
                        selectedVegetables[id] -= 1;
                        document.getElementById(`qty-${id}`).textContent = selectedVegetables[id];
                        updateOrderSummary();
                    }
                });
            });

            // Load recent orders
            loadRecentOrders();
        }

        // Load recent orders
        function loadRecentOrders() {
            const recentOrdersContainer = document.getElementById('recent-orders');
            recentOrdersContainer.innerHTML = '';
            
            if (recentOrders.length === 0) {
                recentOrdersContainer.innerHTML = '<p style="text-align: center; color: var(--dark-gray);">No recent orders</p>';
                return;
            }
            
            recentOrders.forEach(order => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-title">
                        <span>Order ${order.id}</span>
                        <span>${order.date}</span>
                    </div>
                    <p><strong>Vendor:</strong> ${order.vendor}</p>
                    <p><strong>Items:</strong> ${order.items}</p>
                    <div class="vendor-info">
                        <span>Status: ${order.status}</span>
                        <span class="price">${order.total}</span>
                    </div>
                `;
                recentOrdersContainer.appendChild(card);
            });
        }

        // Load vendor dashboard
        function loadVendorDashboard() {
            vendorVegetableList.innerHTML = '';
            
            vegetables.forEach(veg => {
                const price = veg.vendorPrices[currentUserId] || veg.basePrice;
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-title">
                        <span>${veg.name}</span>
                        <span class="price">₹${price}/${veg.unit}</span>
                    </div>
                    <div class="form-group">
                        <label for="price-${veg.id}">Update Price (₹ per ${veg.unit})</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="number" id="price-${veg.id}" class="form-control" value="${price}" min="1" max="500">
                            <button class="btn btn-red btn-small" data-action="remove" data-id="${veg.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                vendorVegetableList.appendChild(card);
            });

            // Add event listeners to remove buttons
            document.querySelectorAll('[data-action="remove"]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.closest('button').getAttribute('data-id'));
                    removeVegetable(id);
                });
            });
        }

        // Load delivery dashboard
        function loadDeliveryDashboard() {
            const todaysDeliveriesContainer = document.getElementById('todays-deliveries');
            todaysDeliveriesContainer.innerHTML = '';
            
            todayDeliveries.forEach(delivery => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-title">
                        <span>${delivery.orderId}</span>
                        <span>${delivery.status}</span>
                    </div>
                    <p><strong>Customer:</strong> ${delivery.customer}</p>
                    <p><strong>Address:</strong> ${delivery.address}</p>
                    <div class="delivery-info">
                        <span>
                            ${delivery.status === 'Delivered' ? 
                                '<span class="status-indicator status-online"></span> Delivered' : 
                                delivery.status === 'In Transit' ? 
                                '<span class="status-indicator" style="background-color: #ff9800;"></span> In Transit' :
                                '<span class="status-indicator status-offline"></span> Pending'
                            }
                        </span>
                        <span class="price">${delivery.amount}</span>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button class="btn btn-small" data-action="update-delivery" data-id="${delivery.id}">
                            <i class="fas fa-edit"></i> Update
                        </button>
                        <button class="btn btn-orange btn-small" data-action="complete-delivery" data-id="${delivery.id}">
                            <i class="fas fa-check"></i> Complete
                        </button>
                    </div>
                `;
                
                todaysDeliveriesContainer.appendChild(card);
            });

            // Add event listeners to delivery action buttons
            document.querySelectorAll('[data-action="update-delivery"]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.closest('button').getAttribute('data-id'));
                    updateDeliveryStatusAction(id);
                });
            });

            document.querySelectorAll('[data-action="complete-delivery"]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.closest('button').getAttribute('data-id'));
                    completeDelivery(id);
                });
            });
        }

        // Update order summary
        function updateOrderSummary() {
            let vegetableCost = 0;
            
            // Calculate vegetable cost
            Object.keys(selectedVegetables).forEach(id => {
                const vegId = parseInt(id);
                const veg = vegetables.find(v => v.id === vegId);
                if (veg && selectedVegetables[vegId] > 0) {
                    const price = veg.vendorPrices[selectedVendor] || veg.basePrice;
                    vegetableCost += price * selectedVegetables[vegId];
                }
            });
            
            // Calculate tax (5%)
            const tax = vegetableCost * 0.05;
            const total = vegetableCost + currentDeliveryFee + tax;
            
            // Update UI
            document.getElementById('vegetable-cost').textContent = `₹${vegetableCost}`;
            document.getElementById('delivery-cost').textContent = `₹${currentDeliveryFee}`;
            document.getElementById('tax-cost').textContent = `₹${tax.toFixed(2)}`;
            document.getElementById('total-cost').textContent = `₹${total.toFixed(2)}`;
        }

        // Update delivery fee
        function updateDeliveryFee() {
            const partner = deliveryPartners.find(p => p.id === selectedDeliveryPartner);
            if (partner) {
                currentDeliveryFee = partner.baseFee;
                updateOrderSummary();
            }
        }

        // Calculate delivery fee based on inputs
        function calculateDeliveryFee() {
            const distance = parseFloat(document.getElementById('base-distance').value) || 5;
            const weight = parseFloat(document.getElementById('base-weight').value) || 2;
            const fuelCost = parseFloat(document.getElementById('fuel-cost').value) || 95;
            
            // Simple formula: base fee + (distance * 2) + (weight * 5) + (fuelCost * 0.1)
            const calculatedFee = 20 + (distance * 2) + (weight * 5) + (fuelCost * 0.1);
            
            // Round to nearest 5
            const roundedFee = Math.round(calculatedFee / 5) * 5;
            
            // Update UI
            document.getElementById('delivery-fee').value = `₹${roundedFee}`;
            
            // Update current delivery fee if this partner is selected
            if (selectedDeliveryPartner === currentUserId) {
                currentDeliveryFee = roundedFee;
                updateOrderSummary();
            }
            
            showNotification("Delivery fee calculated successfully!");
        }

        // Apply delivery fee to all orders
        function applyDeliveryFee() {
            const feeInput = document.getElementById('delivery-fee');
            const fee = parseInt(feeInput.value.replace('₹', ''));
            
            if (isNaN(fee) || fee <= 0) {
                showNotification("Please calculate a valid fee first", "error");
                return;
            }
            
            // Update delivery partner's base fee
            const partner = deliveryPartners.find(p => p.id === currentUserId);
            if (partner) {
                partner.baseFee = fee;
            }
            
            // Update current delivery fee if this partner is selected
            if (selectedDeliveryPartner === currentUserId) {
                currentDeliveryFee = fee;
                updateOrderSummary();
            }
            
            showNotification(`Delivery fee of ₹${fee} applied to all orders`);
        }

        // Update vendor prices
        function updateVendorPrices() {
            let updatedCount = 0;
            
            vegetables.forEach(veg => {
                const input = document.getElementById(`price-${veg.id}`);
                if (input) {
                    const newPrice = parseFloat(input.value);
                    if (!isNaN(newPrice) && newPrice > 0) {
                        veg.vendorPrices[currentUserId] = newPrice;
                        updatedCount++;
                    }
                }
            });
            
            showNotification(`Updated prices for ${updatedCount} vegetables`);
            
            // If customer is viewing this vendor, update their view
            if (selectedVendor === currentUserId) {
                loadCustomerDashboard();
                updateOrderSummary();
            }
        }

        // Add new vegetable
        function addNewVegetable() {
            const newId = vegetables.length + 1;
            const newVegetable = {
                id: newId,
                name: `New Vegetable ${newId}`,
                basePrice: 30,
                vendorPrices: {[currentUserId]: 30},
                unit: "kg"
            };
            
            vegetables.push(newVegetable);
            loadVendorDashboard();
            showNotification("New vegetable added. Please update its name and price.");
        }

        // Remove vegetable
        function removeVegetable(id) {
            const index = vegetables.findIndex(v => v.id === id);
            if (index !== -1) {
                vegetables.splice(index, 1);
                loadVendorDashboard();
                showNotification("Vegetable removed");
            }
        }

        // Update vendor status
        function updateVendorStatus() {
            const status = document.getElementById('vendor-status').value;
            const vendor = vendors.find(v => v.id === currentUserId);
            
            if (vendor) {
                vendor.status = status;
                showNotification(`Vendor status updated to ${status}`);
                
                // Update dropdown if needed
                if (selectedVendor === currentUserId) {
                    populateSelectOptions();
                }
            }
        }

        // Update delivery status
        function updateDeliveryStatus() {
            const status = document.getElementById('delivery-status').value;
            const partner = deliveryPartners.find(p => p.id === currentUserId);
            
            if (partner) {
                partner.status = status;
                showNotification(`Delivery status updated to ${status}`);
                
                // Update dropdown if needed
                if (selectedDeliveryPartner === currentUserId) {
                    populateSelectOptions();
                }
            }
        }

        // Update delivery status action
        function updateDeliveryStatusAction(id) {
            const delivery = todayDeliveries.find(d => d.id === id);
            if (delivery) {
                // In a real app, this would open a modal or form
                showNotification(`Update delivery #${delivery.orderId}`, "info");
            }
        }

        // Complete delivery
        function completeDelivery(id) {
            const delivery = todayDeliveries.find(d => d.id === id);
            if (delivery) {
                delivery.status = "Delivered";
                loadDeliveryDashboard();
                showNotification(`Delivery #${delivery.orderId} marked as completed`);
            }
        }

        // Place order
        function placeOrder() {
            const vegetableCost = parseFloat(document.getElementById('vegetable-cost').textContent.replace('₹', ''));
            
            if (vegetableCost === 0) {
                showNotification("Please add some vegetables to your order!", "error");
                return;
            }
            
            if (!selectedVendor) {
                showNotification("Please select a vendor!", "error");
                return;
            }
            
            if (!selectedDeliveryPartner) {
                showNotification("Please select a delivery partner!", "error");
                return;
            }
            
            const vendor = vendors.find(v => v.id === selectedVendor);
            const deliveryPartner = deliveryPartners.find(d => d.id === selectedDeliveryPartner);
            
            if (vendor.status !== 'online') {
                showNotification("Selected vendor is currently offline!", "error");
                return;
            }
            
            if (deliveryPartner.status !== 'online') {
                showNotification("Selected delivery partner is currently offline!", "error");
                return;
            }
            
            const tax = vegetableCost * 0.05;
            const total = vegetableCost + currentDeliveryFee + tax;
            
            // Add to recent orders
            const orderId = recentOrders.length + 1;
            const orderDate = new Date().toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Create order summary
            let itemsSummary = "";
            Object.keys(selectedVegetables).forEach(id => {
                const vegId = parseInt(id);
                const veg = vegetables.find(v => v.id === vegId);
                if (veg && selectedVegetables[vegId] > 0) {
                    if (itemsSummary) itemsSummary += ", ";
                    itemsSummary += `${veg.name} (${selectedVegetables[vegId]}${veg.unit})`;
                }
            });
            
            const newOrder = {
                id: orderId,
                date: orderDate,
                vendor: vendor.name,
                items: itemsSummary,
                total: `₹${total.toFixed(2)}`,
                status: "Placed"
            };
            
            recentOrders.unshift(newOrder);
            
            // Add to today's deliveries if logged in as delivery partner
            if (currentUserType === 'delivery') {
                const deliveryId = todayDeliveries.length + 1;
                const newDelivery = {
                    id: deliveryId,
                    orderId: `#ORD-${1000 + orderId}`,
                    customer: "New Customer",
                    address: "To be assigned",
                    amount: `₹${total.toFixed(2)}`,
                    status: "Pending"
                };
                todayDeliveries.push(newDelivery);
                loadDeliveryDashboard();
            }
            
            showNotification(`Order placed successfully! Total: ₹${total.toFixed(2)}`);
            
            // Reset order
            selectedVegetables = {};
            loadCustomerDashboard();
            updateOrderSummary();
        }

        // Show notification
        function showNotification(message, type = "success") {
            notification.querySelector('span').textContent = message;
            
            // Change icon based on type
            const icon = notification.querySelector('i');
            if (type === "error") {
                icon.className = "fas fa-exclamation-circle";
                notification.style.backgroundColor = "#f44336";
            } else if (type === "info") {
                icon.className = "fas fa-info-circle";
                notification.style.backgroundColor = "#2196f3";
            } else {
                icon.className = "fas fa-check-circle";
                notification.style.backgroundColor = "#2e7d32";
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
